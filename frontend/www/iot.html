<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Smart Farming ‚Äì Live IoT & AI Advisory</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background:
                linear-gradient(rgba(0, 0, 0, .55), rgba(0, 0, 0, .9)),
                url("https://cdn.pixabay.com/photo/2017/02/23/13/05/agriculture-2092576_1920.jpg") no-repeat center center fixed;
            background-size: cover;
            color: #fff;
        }


        /* Header */
        header {
            background: rgba(0, 0, 0, .6);
            backdrop-filter: blur(10px);
            padding: 18px 60px;
            border-bottom: 1px solid rgba(255, 255, 255, .15);
        }

        header h3 {
            margin: 0;
            font-weight: 700
        }

        /* Hero */
        .hero {
            padding: 110px 60px 50px;
            max-width: 1200px;
        }

        .hero h1 {
            font-size: 44px;
            font-weight: 700
        }

        .hero p {
            max-width: 700px;
            color: #ddd
        }

        /* Cards */
        .cards {
            max-width: 1200px;
            margin: 0 auto 50px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 25px;
            padding: 0 60px;
        }

        .iot-card {
            background: rgba(255, 255, 255, .08);
            border: 1px solid rgba(255, 255, 255, .2);
            border-radius: 18px;
            padding: 30px 25px;
            text-align: center;
        }

        .value {
            font-size: 46px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .label {
            opacity: .85
        }

        /* AI Section */
        .ai-box {
            max-width: 1200px;
            margin: 0 auto 80px;
            padding: 0 60px;
        }

        .ai-panel {
            background: rgba(0, 0, 0, .55);
            border: 1px solid rgba(255, 255, 255, .2);
            border-radius: 20px;
            padding: 30px;
        }

        #adviceResult {
            min-height: 120px;
            margin-top: 15px;
            background: rgba(255, 255, 255, .08);
            border-radius: 12px;
            padding: 15px;
            font-size: 15px;
            color: #e5ffe5;
            white-space: pre-line;
        }

        /* Footer */
        footer {
            background: rgba(0, 0, 0, .85);
            padding: 20px;
            text-align: center;
            font-size: 14px;
            color: #aaa;
        }
    </style>
    <script src="config.js"></script>
</head>

<body>

    <header>
        <h3>üåæ Smart Farming ‚Äì Live IoT & AI Advisory</h3>
    </header>

    <section class="hero">
        <h1>Real-Time Field Monitoring & AI Advisory</h1>
        <p>
            Live sensor values from your field combined with AI-powered crop advisory.
        </p>
    </section>

    <section class="cards">
        <div class="iot-card">
            <div class="value" id="temp">--</div>
            <div class="label">Temperature (¬∞C)</div>
        </div>

        <div class="iot-card">
            <div class="value" id="hum">--</div>
            <div class="label">Humidity (%)</div>
        </div>

        <div class="iot-card">
            <div class="value" id="soil">--</div>
            <div class="label">Soil Moisture</div>
        </div>
    </section>

    <section class="ai-box">
        <div class="ai-panel">
            <h5>AI Advisory System</h5>
            <p class="small text-secondary">
                Get instant farming suggestions based on your live sensor values.
            </p>

            <button onclick="getAdvice()" class="btn btn-success px-4">
                AI Advice
            </button>

            <div id="adviceResult">
                Click ‚ÄúAI Advice‚Äù to receive recommendations.
            </div>
        </div>
    </section>

    <footer>¬© 2026 Smart Farming AI Platform</footer>

    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
        let latestData = null;

        // Live IoT stream
        const socket = io();
        socket.on("sensor", d => {
            latestData = d;
            temp.innerText = d.temperature.toFixed(2);
            hum.innerText = d.humidity.toFixed(2);
            soil.innerText = d.soil;
        });
        async function getAdvice() {

            if (!latestData) {
                adviceResult.innerText = "Waiting for sensor data...";
                return;
            }

            adviceResult.innerText = "Analyzing your field...";

            const res = await fetch(API_BASE_URL + "/api/ai/advice", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    temperature: latestData.temperature,
                    humidity: latestData.humidity,
                    soil: latestData.soil
                })
            });

            const data = await res.json();
            adviceResult.innerText = data.advice;
        }

    </script>

</body>

</html>